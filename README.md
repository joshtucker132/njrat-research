# njrat-research

## Important Links

[Source Code] https://github.com/AliBawazeEer/RAT-NjRat-0.7d-modded-source-code

[Cynet Report] (https://www.cynet.com/attack-techniques-hands-on/njrat-report-bladabindi/)

[njRAT Injector Code Analysis] (https://medium.com/@shimasakisan/njrat-injector-code-analysis-d005b6808e96)

[VMWare Threat Analysis] (https://www.carbonblack.com/blog/threat-analysis-unit-tau-threat-intelligence-notification-njrat/)

[MITRE ATT&CK Report] (https://attack.mitre.org/software/S0385/)
                         

## Research and Analysis

  As of 2019, the Advanced Persistant Threat (APT) group 33, often linked to an Iranian state actor, has been reported to make extensive use of Remote Administration Tools (RATs). These tools give malicious actors complete remote access to a victim's device, with the ability to view webcam feeds, add or modify files, record keystrokes, etc. APT33 has shown a particular preference for one of these tools known as njRAT.
  
  First appearing in 2013, njRAT can be broken down into two main components: the actual malware that runs on the attacker's device and the executable generated by the malware that is then run on the victim's device (often referred to as the injector). In order to perform this analysis, I downloaded 'njRAT v0.7d.exe' as well as the necessary helper files. I then tried to run the malware on both Windows 10 and 7 virtual machines(VMs). On both VMs, the user interface opened and gave the option to build a new injector. 
  
![building njrat injector](https://github.com/joshtucker132/njrat-research/blob/master/building-injector.png?raw=true)

  The 'Host' field requires the name of the domain that will host the Command and Control (C&C) server. In order to avoid detection, njRAT uses DynamicDNS to change the IP address of the C&C server without changing the hostname. For this analysis, I made an account with NoIP, a DynamicDNS manager, and registered a domain name as 'njrattest.zapto.org'. I then downloaded the Domain Update Client to the machine running the malware, which switches the server to a new IP address every five minutes and updates the DNS servers.
  
![domain update client](https://github.com/joshtucker132/njrat-research/blob/master/duc.png?raw=true)

  The remaining fields in the injector builder are optional to change. I choose to use the defaults, setting the injector executable name to 'server.exe' and the directory the injector is copied into on the victim machine to '%TEMP%'. I also left the options to copy the injector into the startup processes selected. When I clicked 'Build', the 'server.exe' injector was created.
  
![injector created](https://github.com/joshtucker132/njrat-research/blob/master/injector-created.png?raw=true)
